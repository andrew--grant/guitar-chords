<chords-menu>
    <div class="chords-menu"></div>
    <style>
        .chords-menu {
            /*background-color: #eee;*/
            /*margin: .1em .1em 2em 2em;*/
            margin: auto;
            text-align: center;
            font-size: 2em;
            max-width: 70%;
        }
        
        .chord-button {
            background-color: #222;
            margin: .2em;
            padding: .3em;
            color: #eee;
            font-size: 1.1em;
            border: none;
            border-radius: 4px;
            outline: none;
        }
        
        .chord-button:hover {
            background-color: #c22;
            color: white;
            font-size: 1.1em;
        }
        
        .chord-button:active {
            background-color: #c22;
            color: white;
            height: 100%;
        }
        
        .chord-button-active {
            background-color: #c22;
            color: white;
            height: 100%;
        }
        
        .chord-selected {
            background-color: #c22;
        }
    </style>
    <script>
        var self = this;
        self.chordIndex = 0;
        self.selectedChord = null;

        self.on('mount', function() {
            // apply default menu items filter
            self.renderMenuItems('Default');
        });

        self.on('update', function() {
            self.selectedChord = self.opts.chords[self.chordIndex];
        });

        chordSelected(e) {
            self.chordIndex = e.target.id;
            $('.chord-button').removeClass('chord-selected');
            $(e.target).addClass('chord-selected');
            self.opts.doselect(self.opts.chords[self.chordIndex]);
            if (e.target.isVoiceCommand) {
                // change select UI when voice activated
                // $('#chord-select')[0].selectedIndex = self.chordIndex
            }
        }

        filterChords(filter) {
            var resultsArr = [];
            filter = filter.toLowerCase();
            if (filter.indexOf('key of ') > -1) {
                filter = filter.replace('key of ', '');
            }
            if (filter == 'load...') {
                alert('load logic here');
            }
            if (filter == 'default') {
                resultsArr = opts.chords;
            } else {
                for (var i = 0; i < opts.chords.length; i++) {
                    if (_.includes(opts.chords[i].families, filter)) {
                        resultsArr.push(opts.chords[i]);
                    }
                }
            }
            return resultsArr;
        }

        renderMenuItems(filter) {
            // reset container  
            $('.chords-menu').off('click');
            //$('.chord-button-active').removeClass('chord-button-active');
            var chords = null;
            var fadeSpeed = 'fast';
            $('.chords-menu').fadeOut(fadeSpeed, function() {
                $('.chords-menu').empty();
                // which view of chords to render?
                if (filter) {
                    chords = self.filterChords(filter);
                } else {
                    // default, render all or some 'simple' or 'popular' set?
                    chords = self.opts.chords;
                }
                // render chords
                for (var i = 0; i < chords.length; i++) {
                    $('.chords-menu').append('<button id=\'' + i + '\'  class=\'chord-button\'>' + chords[i].name + '</button>');
                }
                $('.chords-menu').fadeIn(fadeSpeed, function() {
                    //$('.chords-menu').empty();
                });
            });

            // attach events
            $('.chords-menu').on('click', '.chord-button', function(e) {
                // todo: using jQuery v1.10.2, could be why error on windows??
                var chord = chords[e.target.id];
                // keep this menu item active/selected
                $('.chord-button-active').removeClass('chord-button-active');
                $('#' + e.target.id).addClass('chord-button-active');
                for (var i = 0; i < chord.families.length; i++) {
                    // console.log(chord.families[i] + ' / ' + filter);
                    // todo: remove this pointless loop! (test)
                }
                self.opts.doselect(chord);
            });
        }
    </script>
</chords-menu>